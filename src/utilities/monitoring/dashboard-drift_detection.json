{"id":"56fa7d0b-9158-4f64-b514-58c5622260eb","eTag":"7HvTYipaYGE77t7MLUsx5Q==","title":"drift_detection","tiles":[{"id":"67f90ef9-0789-4954-ab99-8814874e7760","title":"Drift Over Time","query":"// Please enter your KQL query (Example):\n// <table name>\n// | where <datetime column> between (['_startTime'] .. ['_endTime']) // Time range filtering\n// | where isempty(['run_id']) or <column name> == ['run_id'] // Single selection filtering\n// | take 100\ndata_drift_result|where run_id ==run_id_param|extend feature_drift = iff(wasserstein==\"\",toreal(euclidean)/toreal(target_dcount),toreal(wasserstein)/(toreal(target_mean)+1))|summarize overall_drift=avg(feature_drift) by target_start_date| order by target_start_date","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"line","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":0,"y":0,"width":10,"height":10},"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Drift score","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"specified","value":["overall_drift"]},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"crossFilter":[{"interaction":"column","property":"target_start_date","parameterId":"57c8ba44-f98d-4863-8e21-856a76f268d2","disabled":false}]},"usedParamVariables":["run_id_param"]},{"id":"ca1175ee-fc4f-4027-9f83-416cb2c02934","title":"Features Drifts Contribution","query":"// Please enter your KQL query (Example):\n// <table name>\n// | where <datetime column> between (['_startTime'] .. ['_endTime']) // Time range filtering\n// | where isempty(['run_id']) or <column name> == ['run_id'] // Single selection filtering\n// | take 100\nlet tbl = data_drift_result|where run_id == run_id_param;\nlet tbl1 = tbl\n|extend feature_drift = toreal(wasserstein),feature = numeric_feature\n|summarize feature_drift =avg(feature_drift) by feature,target_start_date;\nlet tbl2= tbl |extend feature_drift =toreal(euclidean)/toreal(target_dcount),toreal(wasserstein)/(toreal(target_mean)+1),feature =categorical_feature\n|summarize feature_drift =avg(feature_drift) by feature,target_start_date;\ntbl1| union(tbl2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"stacked100column","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":10,"y":0,"width":14,"height":10},"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"drift contribution","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"specified","value":"target_start_date"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"specified","value":["feature"]},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"crossFilter":[{"interaction":"column","property":"feature","parameterId":"4a757dd0-2916-4d64-989d-79c1bf57bac1","disabled":false},{"interaction":"column","property":"target_start_date","parameterId":"57c8ba44-f98d-4863-8e21-856a76f268d2","disabled":false}]},"usedParamVariables":["run_id_param"]},{"id":"3ae5bc3d-cd20-4af6-8908-d6636c87ae3a","title":"Feature Value Distribution","query":"// Please enter your KQL query (Example):\n// <table name>\n// | where isempty(['run_id_param']) or <column name> == ['run_id_param'] // Single selection filtering\n// | where isempty(['feature_name']) or <column name> == ['feature_name'] // Single selection filtering\n// | where isempty(['start_date']) or <column name> == ['start_date'] // Single selection filtering\n// | take 100\nfeature_distribution\n|where feature == feature_name and ['datetime'] == start_date\n|mv-expand value=parse_json(value_list) to typeof(string ), count=parse_json(count_list) to typeof(real )\n|project value, ['count'], feature_name | limit 1000","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"column","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":10,"y":10,"width":14,"height":8},"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["feature_name","start_date"]},{"id":"766b1648-4ab0-4555-8f01-2de950efaa51","title":"Feature details","query":"data_drift_result\n| summarize  avg(toreal(column_ifexists(metric,\"none\"))) by target_start_date| order by target_start_date","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"line","pageId":"c2f0e928-c30a-4e4e-a3f7-34ce84e8e1e5","layout":{"x":0,"y":0,"width":15,"height":12},"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"specified","value":"target_start_date"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["metric"]},{"id":"bc25ae53-4968-4a21-a003-3c8f39c1886b","title":"New tile","query":"// Please enter your KQL query (Example):\n// <table name>\n// | where isempty(['run_id_param']) or <column name> == ['run_id_param'] // Single selection filtering\n// | where isempty(['start_date']) or <column name> == ['start_date'] // Single selection filtering\n// | where isempty(['feature_name']) or <column name> == ['feature_name'] // Single selection filtering\n// | where isempty(['metric']) or <column name> == ['metric'] // Single selection filtering\n// | take 100\nlet tbl2= data_drift_result | where target_start_date == start_date| summarize base_dcount= avg(toreal(base_dcount)), target_dcount= avg(toreal(target_dcount)),euclidean=avg(toreal(euclidean)) by categorical_feature| project feature = categorical_feature, base_dcount, target_dcount,euclidean;\nlet tbl1= data_drift_result | where target_start_date == start_date| summarize base_min= avg(toreal(base_min)), target_min= avg(toreal(target_min)),base_max=avg(toreal(base_max)), target_max=avg(toreal(target_max)),base_mean=avg(toreal(base_mean)),target_mean=avg(toreal(target_mean)), wassertstein = avg(toreal(wasserstein)) by numeric_feature| project feature = numeric_feature, base_min, target_min, base_max, target_max, base_mean, target_mean, wassertstein;\ntbl1|union tbl2\n| sort by wassertstein\n\n\n","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"table","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":0,"y":10,"width":10,"height":8},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[],"colorRulesDisabled":false,"colorStyle":"bold","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["start_date"]}],"dataSources":[{"id":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","name":"db01","clusterUri":"https://adx02.westus2.kusto.windows.net/","database":"db01","kind":"manual-kusto","scopeId":"kusto"}],"$schema":"https://dataexplorer.azure.com/static/d/schema/21/dashboard.json","autoRefresh":{"enabled":false},"parameters":[{"kind":"string","id":"212933b6-2f27-4929-bb49-4dee3dbf62e0","displayName":"base_table","variableName":"base_table","selectionType":"single-all","defaultValue":{"kind":"value","value":"ISDWeather"},"dataSource":{"kind":"query","consumedVariables":[],"query":"// Please enter your KQL query (Example):\n// <table name>\n// | where isempty(['run_id_param']) or <column name> == ['run_id_param'] // Single selection filtering\n// | where isempty(['start_date']) or <column name> == ['start_date'] // Single selection filtering\n// | where isempty(['feature_name']) or <column name> == ['feature_name'] // Single selection filtering\n// | where isempty(['metric']) or <column name> == ['metric'] // Single selection filtering\n// | take \n\n data_drift_result| extend base_table = split(run_id,\"_\")[0]| project tostring(base_table)| distinct base_table","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"base_table"}},"showOnPages":{"kind":"all"}},{"kind":"string","id":"b86c01f4-1574-4495-b578-97763fe7b3bc","displayName":"target_table","variableName":"target_table","selectionType":"single","defaultValue":{"kind":"value","value":"ISDWeather"},"dataSource":{"kind":"query","consumedVariables":[],"query":"// Please enter your KQL query (Example):\n// <table name>\n// | where isempty(['run_id_param']) or <column name> == ['run_id_param'] // Single selection filtering\n// | where isempty(['start_date']) or <column name> == ['start_date'] // Single selection filtering\n// | where isempty(['feature_name']) or <column name> == ['feature_name'] // Single selection filtering\n// | where isempty(['metric']) or <column name> == ['metric'] // Single selection filtering\n// | take \n\n data_drift_result| extend target_table = split(run_id,\"_\")[1]| project tostring(target_table)| distinct target_table","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"target_table"}},"showOnPages":{"kind":"all"}},{"kind":"string","id":"d1b87660-c17c-4724-ada3-6470765e23aa","displayName":"run_id","variableName":"run_id_param","selectionType":"single","defaultValue":{"kind":"value","value":"ISDWeather_Train_ISDWeather_Scoring_01/03/2010_02/03/2010_06/10/2010_07/10/2010"},"dataSource":{"kind":"query","consumedVariables":["base_table","target_table"],"query":"data_drift_result|where split(run_id,\"_\")[0] == base_table and split(run_id,\"_\")[1] == target_table | distinct run_id","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"run_id"}},"showOnPages":{"kind":"all"}},{"kind":"string","id":"57c8ba44-f98d-4863-8e21-856a76f268d2","displayName":"start_date","variableName":"start_date","selectionType":"single","defaultValue":{"kind":"value","value":"0100-01-01T00:00:00"},"dataSource":{"kind":"static","values":[{"value":"0100-01-01T00:00:00"}]},"showOnPages":{"kind":"all"}},{"kind":"string","id":"4a757dd0-2916-4d64-989d-79c1bf57bac1","displayName":"feature","variableName":"feature_name","selectionType":"single","defaultValue":{"kind":"value","value":"usaf"},"dataSource":{"kind":"query","consumedVariables":[],"query":"// Please enter your KQL query (Example):\n// <table name>\n// | where isempty(['run_id_param']) or <column name> == ['run_id_param'] // Single selection filtering\n// | where isempty(['start_date']) or <column name> == ['start_date'] // Single selection filtering\n// | take 100\nlet tbl1= data_drift_result | distinct numeric_feature|project feature =numeric_feature;\nlet tbl2= data_drift_result | distinct categorical_feature |project feature =categorical_feature;\ntbl1|union tbl2\n \n","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"feature"}},"showOnPages":{"kind":"all"}},{"kind":"string","id":"99846391-56ca-486b-aab0-d762d29953a3","displayName":"metric","variableName":"metric","selectionType":"single-all","defaultValue":{"kind":"value","value":"euclidean"},"dataSource":{"kind":"query","consumedVariables":["feature_name"],"query":"let num_features = data_drift_result|distinct numeric_feature|project feature = numeric_feature|extend type =\"numerical\";\nlet cat_features = data_drift_result|distinct categorical_feature|project feature = categorical_feature|extend type =\"categorical\";\nlet feature_dict = num_features|union cat_features;\nlet type_out = toscalar(feature_dict|where feature == feature_name|project type);\nlet metrics_dict = datatable(metric:string, type: string)['euclidean', 'categorical',  \"target_dcount\",'categorical', \"target_min\", 'numerical',\"target_max\", 'numerical', \"target_mean\", 'numerical', \"wasserstein\", 'numerical'];\nmetrics_dict|where type == type_out| project metric\n","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"metric"}},"showOnPages":{"kind":"all"}}],"pages":[{"name":"Drift Overview","id":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab"},{"name":"Feature Detail","id":"c2f0e928-c30a-4e4e-a3f7-34ce84e8e1e5"}],"schema_version":"21"}